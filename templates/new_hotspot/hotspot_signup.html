<input type="hidden" value="{{ shop_id_select }}" id="shop_id_select" />
<div class="row justify-content-center">
    <div class="col-12 col-lg-12 col-xl-12">
        <div class="card">
            <div class="card-header">
                <div class="row align-items-center">
                    <div class="col">
                        <!-- Nav -->
                        <h6 class="header-pretitle">
                            {{ gettext("Trang_dang_ky") }}
                        </h6>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <form method="POST" id="login_form_settings" action="/login_form_settings/{{ shop_id_select }}" enctype="multipart/form-data">
                    <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}" />

                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox1" name="phone_visible" type="checkbox" {% if login_form.phone and login_form.phone|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox1">{{ gettext('HotspotRegisterScreenPhoneText')}}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if login_form.phone_require and
                                            login_form.phone_require|lower
                                            == 'true' %}is-active{% endif %}">
                                    <label class="custom-control-label" for="switch1" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch1" type="checkbox" name="phone_require" {% if login_form.phone_require and login_form.phone_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox2" name="email_visible" type="checkbox" {% if login_form.email and login_form.email|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox2">{{ gettext('HotspotRegisterScreenEmailText')}}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if
                                        login_form.email_require and
                                        login_form.email_require|lower ==
                                        'true' %}is-active{% endif %}">
                                    <label class="custom-control-label" for="switch2" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch2" type="checkbox" name="email_require" {% if login_form.email_require and login_form.email_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox3" name="name_visible" type="checkbox" {% if login_form .name and login_form.name|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox3">{{ gettext('HotspotRegisterScreenNameText')}}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch{% if login_form
                                        .name_require and login_form
                                        .name_require|lower == 'true' %} is-active{% endif %}">
                                    <label class="custom-control-label" for="switch3" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch3" type="checkbox" name="name_require" {% if login_form.name_require and login_form.name_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox4" name="birthday_visible" type="checkbox" {% if login_form.birthday and login_form.birthday|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox4">{{ gettext('HotspotRegisterScreendayofbirthText')}}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch{% if login_form
                                        .birthday_require and login_form.birthday_require|lower == 'true' %} is-active{% endif %}">
                                    <label class="custom-control-label" for="switch4" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch4" type="checkbox" name="birthday_require" {% if login_form.birthday_require and login_form.birthday_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox5" name="year_birthday_visible" type="checkbox" {% if login_form.year_birthday and login_form.year_birthday|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox5">{{ gettext('HotspotRegisterScreenYearofbirthText')}}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if login_form.year_birthday_require and login_form.year_birthday_require|lower == 'true' %}is-active{% endif %}">
                                    <label class="custom-control-label" for="switch5" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch5" type="checkbox" name="year_birthday_require" {% if login_form.year_birthday_require and login_form.year_birthday_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox6" name="gender_visible" type="checkbox" {% if login_form.gender and login_form.gender|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox6">{{ gettext('HotspotRegisterScreenGenderText')}}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if
                                            login_form
                                        .gender_require and login_form
                                        .gender_require|lower == 'true' %} is-active{% endif %}">
                                    <label class="custom-control-label" for="switch6" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch6" type="checkbox" name="gender_require" {% if login_form.gender_require and login_form.gender_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox7" name="company_visible" type="checkbox" {% if login_form.company and login_form.company|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox7">{{ gettext("Cong_ty") }}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if login_form.company_require and login_form.company_require|lower == 'true' %} is-active{% endif %}">
                                    <label class="custom-control-label" for="switch7" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch7" type="checkbox" name="company_require" {% if login_form.company_require and login_form.company_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox9" name="vocation_visible" type="checkbox" {% if login_form.vocation and login_form.vocation|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox9">{{ gettext("Nghe_nghiep") }}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if login_form.vocation_require and login_form.vocation_require|lower == 'true' %}is-active{% endif %}">
                                    <label class="custom-control-label" for="switch7" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch9" type="checkbox" name="vocation_require" {% if login_form.vocation_require and login_form.vocation_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox8" name="company_role_visible" type="checkbox" {% if login_form.company_role and login_form.company_role|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox8">{{ gettext("Chuc_vu") }}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if login_form.company_role_require and login_form.company_role_require|lower == 'true' %}is-active{% endif %}">
                                    <label class="custom-control-label" for="switch8" style="padding-left: 10px; font-size: 15px;">{{ gettext("bat_buoc") }}</label>
                                    <input class="custom-control-input" id="switch8" type="checkbox" name="company_role_require" {% if login_form.company_role_require and login_form.company_role_require|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if shop.merchant_id|package_merchant != "Brand" %}
                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox10" name="connect_with_facebook" type="checkbox" {% if login_form.connect_with_facebook and login_form.connect_with_facebook|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox10">{{ gettext("Ket_noi_qua_Facebook") }}</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group row">
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="custom-control custom-checkbox">
                                <input class="custom-control-input" id="checkbox12" name="connect_with_zalo" type="checkbox" {% if login_form.connect_with_zalo and login_form.connect_with_zalo|lower=="true" %}checked{% endif %}>
                                <label class="custom-control-label" for="checkbox12">{{ gettext("Ket_noi_qua_Zalo") }}</label>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 u-mb-medium">
                            <div class="u-block">
                                <div class="custom-control custom-switch {% if login_form.allow_access_friend_zalo and login_form.allow_access_friend_zalo|lower == 'true' %}is-active{% endif %}">
                                    <label class="custom-control-label" for="switch10" style="padding-left: 10px; font-size: 15px;">{{ gettext("Dong_bo_ban_be") }}</label>
                                    <input class="custom-control-input" id="switch10" type="checkbox" name="allow_access_friend_zalo" {% if login_form.allow_access_friend_zalo and login_form.allow_access_friend_zalo|lower=="true" %}checked{% endif %}>
                                </div>
                            </div>
                        </div>

                    </div>
                    {% endif %}
                    <div class="form-group">                        
                        <img class="preview" id="view_background"
                        {% if login_form.background %}
                            src="//files.nextify.vn/{{ login_form.background }}"
                            style="width: auto;height: 200px"
                            {% endif %}>                       
                        <label  for="background_fr">Ảnh Cover
                            (<span>{{ gettext("Kich_thuoc_goi_y_1280_px_×_720_px") }}</span>)</label>
                        <input type="file" class="imgInp form-control" id="background_fr" name="background_fr">
                    </div>
                    <div class="form-group">
                        <label >{{ gettext('HotspotRegisterScreenWelcomemessageText')}}</label>
                        <textarea class="form-control" id="welcome_text" name="welcome_text" rows="6">
                                                              {% if login_form.welcome_text and login_form.welcome_text|length > 1 %}
                                                                  {{ login_form.welcome_text }}
                                                              {% else %}
                                                                  {{ gettext("Dang_ky_khach_hang_than_thiet_de_nhan_cac_uu_dai_hap_dan") }} <br/>
                                                                  {{ gettext("Get_connected_with_FREE_WIFI") }}
                                                              {% endif %}
                                                        </textarea>
                    </div>
                    <div class="form-group">
                        <label >{{ gettext('HotspotRegisterScreenBirthdaymessageText')}}</label>
                        <textarea class="form-control" id="birthday_text" name="birthday_text" rows="6">
                                                              {% if login_form.birthday_text and login_form.birthday_text|length > 1 %}
                                                                  {{ login_form.birthday_text }}
                                                              {% else %}
                                                                  {{ gettext("Dung_quen_nhap_ngay_sinh_de_nhan_qua_tu_chung_toi_nhe") }}
                                                              {% endif %}
                                                        </textarea>
                    </div>
                    <div class="form-group">
                        <label >{{ gettext('HotspotRegisterScreenConnectbuttonText')}}</label>
                        <textarea class="form-control" id="welcome_button" name="welcome_button" rows="2">
                                                      {% if login_form.welcome_button and login_form.welcome_button|length > 1 %}
                                                          {{ login_form.welcome_button }}
                                                      {% else %}
                                                      {{ gettext("Ket_noi_Wi-Fi/Go_Online") }}
                                                      {% endif %}
                                                </textarea>
                    </div>
                    <div class="c-field u-mb-small">
                        <label class="c-field__label" for="tag_select">{{ gettext("Chon_tag_khach_hang:") }}</label>
                        <select class="form-control select2" name="tags" id="tag_select" multiple="multiple">
                            {% for tag in tags %}
                            <option value="{{ tag._id }}">{{ tag.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                        <input type="hidden" id="select_tags_filter" name="real_tags_filter" />
                        <input type="hidden" name="source_tags" id="source_tags" value="{{ login_form.tag|handle_jinja_list }}" />
                    <div class="custom-control custom-checkbox">
                        <input class="custom-control-input" type="checkbox" id="otp" {% if login_form %}{% if login_form.otp %}checked {% endif %}{% endif %}>
                        <label class="custom-control-label" for="otp">{{ gettext("Su_dung_OTP") }} </label>
                        <span class="d-inline-block" tabindex="0" data-toggle="tooltip" title="Cần đăng ký hoặc kích hoạt SMS Brandname cho tính năng này."
                            >
                            <button class="btn btn-primary btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question"></i></button>
                            
                        </span>
                    </div>
                    <input type="hidden" value="" name="otp" id="otp_val" />
                </form>
            </div>
            <div class="card-footer">
                <div class="col-3" style="float:right">
                 <button class="btn btn-lg btn-block btn-primary" id="login_setting_btn">{{ gettext('HotspotRegisterScreenUpdateText')}}
                    </button>
                    </div>
            </div>
        </div>
    </div>
</div>

{% block js %}
<script nonce="{{ csp_nonce() }}">
$(document).ready(function() {
    // ex_hotspot_method = $('#ex_hotspot_method').val();
    // if (ex_hotspot_method === 'profile_code') {
    //     $("#default_code_div").hide();
    // } else {
    //     $("#default_code_div").show();
    // };
    // $('#hotspot_method').select2();
    // $('#hotspot_method').on('change.select2', function(e) {
    //     method = $(this).val();
    //     if (method === 'profile_code') {
    //         $("#default_code_div").hide();
    //     } else {
    //         $("#default_code_div").show();
    //     }
    // });
    $('textarea').each(function() {
        $(this).val($(this).val().trim());
    });
    $('input').each(function() {
        $(this).val($(this).val().trim());
    });
    var shop_id_select = $("#shop_id_select").val();
    var url_preview = '/preview/' + shop_id_select + '/register';

    $("#preview").empty();
    bioMp(document.getElementById('preview'), {
        url: url_preview,
        view: 'front',
        image: '/static/images/iphone_simulator/img_preview_mobile.svg',
        height: 618,
        width: 308
    });


     $('#tag_select').select2();
               $('#tag_select').on("change", function (e) {
        if($('#tag_select').val()){
          $('#select_tags_filter').val($('#tag_select').val().toString());
        }else{
          $('#select_tags_filter').val("");
        }
    });


          var source_tags = $("#source_tags").val();
          if (source_tags.length != 0){
            var data_soure_tags = JSON.parse(source_tags.replace(/\'/g, '"'));
          };

            $("#tag_select").val(data_soure_tags);
            $('#tag_select').trigger('change');

    function readURL(input, input_view) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            var view_id = '#' + input_view;
            reader.onload = function (e) {
                $(view_id).attr('src', e.target.result);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }
    function validate(photo) {
        var file_size = $(photo)[0].files[0].size;
        var file = $(photo).val();
        var exts = ['jpg', 'png', 'jpeg'];
        if (file) {
            var get_ext = file.split('.');
            get_ext = get_ext.reverse();
            if ($.inArray(get_ext[0].toLowerCase(), exts) > -1) {
                if (file_size > 3670016) {
                    return "big_file";
                } else {
                    return true;
                }
            } else {
                return false;
            }
        }

    }
    $("#background_fr").change(function () {
        readURL(this, 'view_background');
    });
    $("#background_fr").change(function () {
        if (validate(this) == true) {
            swal('{{ gettext("Chon_File_thanh_cong") }}', '', 'success');
            $('#view_background').show();
            readURL(this, 'view_background');
        } else {
            swal('{{ gettext("File_khong_dung_dinh_dang") }}', '', 'error');
            $('#background_fr').val('');
            $('#view_background').hide();
        }
    });
    
    $("#login_setting_btn").click(function(e) {
        var action = $('#login_form_settings').attr('action');
        $("#otp_val").val($("#otp").is(":checked"));
        var form = $('#login_form_settings')[0];
        var data = new FormData(form);
        $.ajax({
            type: "POST",
            url: action,
            data: data,
            cache: false,
            contentType: false,
            processData: false, 
            success: function(data) {
                $.ajax({
                      url: "/hotspot_type/register",
                      type: 'GET',
                      data: {
                        'shop_id_select': shop_id_select
                    },
                      beforeSend: function() {
                          $(".detail-splash").empty();
                      },
                      success: function(data) {
                          $(".detail-splash").append(data);
                    }
                });
            }
        });
        e.preventDefault();
    });

    $(".c-switch").on("click", function (t) {
        var e = $(this).find(".custom-control-input");
        return $(this).hasClass("is-disabled") || ($(this).hasClass("is-active") && e.attr("checked") ? (e.removeAttr("checked"), $(this).removeClass("is-active")) : (e.attr("checked", "checked"), $(this).addClass("is-active"))), !1
    })
});
</script>
{% endblock %}