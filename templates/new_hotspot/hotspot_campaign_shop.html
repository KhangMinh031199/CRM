{% if cards > 0 %}
    <link rel="stylesheet" href="/static/nextify/css/bs-pagination.min.css">
    <style>
        a:hover {
            color: #f57a33;
        }

        .pagination {
            display: flex;
        }
    </style>
    <div id="campaign_pagination" class="row">
        {% for campaign in hotspot_campaign_shop %}
            <div class="col-6 col-lg-6 col-sm-12">
                <!-- Card -->
                <div class="card">
                    <div class="card-footer card-footer-boxed">
                        <div class="row align-items-center">
                            <div class="col ml-n2">

                                <!-- Title -->
                                <a href="/hotspot_details?shop_id={{ shop_id_select }}&campaign_id={{ campaign._id }}">
                                    <h4 class="card-title">
                                        {% if campaign.name %}
                                            {{ campaign.name }}
                                        {% endif %}

                                    </h4>
                                </a>
                                <!-- Time -->
                                <p class="card-text small text-muted">
                                    <span class="fe fe-clock"></span>
                                    {% if campaign.updated_at %}
                                        {{ campaign.updated_at|human_time }}
                                    {% else %}
                                        {{ campaign.created_at|human_time }}
                                    {% endif %}
                                </p>

                            </div>
                            <div class="col-auto">
                                <div class="custom-control custom-switch {% if campaign.status and campaign.status|lower == 'true' %}is-active{% endif %}"
                                     id="campaign_active_{{ campaign._id }}">
                                    <input class="custom-control-input" id="status_{{ campaign._id }}" type="checkbox"
                                           {% if campaign.status and campaign.status|lower=="true" %}checked{% endif %}>
                                           <label class="custom-control-label"
                                           for="status_{{ campaign._id }}"></label>
                                </div>
                                <script nonce="{{ csp_nonce() }}">
                                    $(document).ready(function () {
                                        $("#campaign_active_{{ campaign._id }}").click(function (e) {
                                            var status = !($("#status_{{ campaign._id }}").is(":checked"));
                                            let checkbox = $(this);
                                            $.ajax({
                                                type: 'POST',
                                                url: '/wifi_camp/{{ shop_id_select }}/active/{{ campaign._id }}',
                                                data: {
                                                    'status': status
                                                },
                                                success: function (response) {
                                                    // Check exist visit
                                                    if (JSON.parse(response).exist == 1){
                                                        swal({
                                                            title: '{{ gettext("Luot_den_trung_voi") }}' + JSON.parse(response).exist_camp_name,
                                                            text: " ",
                                                            type: "error",
                                                            timer: 4000
                                                        });
                                                        $(checkbox).removeClass('is-active');
                                                        $("#status_{{ campaign._id }}").prop('checked', false);
                                                        return 0;
                                                    }
                                                    if (response.includes('false')) {
                                                        swal('{{ gettext("Ban_phai_kich_hoat_it_nhat_1_chien_dich") }}', " ", "error");

                                                    } else {

                                                        swal({
                                                            title: '{{ gettext("Thanh_cong!") }}',
                                                            text: " ",
                                                            type: "success"
                                                        });
                                                        location.reload();
                                                    }
                                                }
                                            });
                                            return false;
                                        });
                                    });
                                </script>
                            </div>

                            {% if campaign.status|lower == "false" and campaign.campaign_type == 'default' %}
                                <div class="col-auto">
                                    <!-- Dropdown -->
                                    <div class="dropdown">

                                        <a href="#" id="remove_{{ campaign._id }}" >
                                            <i class="fe fe-more-vertical"></i>
                                        </a>
                                    </div>
                                    <script nonce="{{ csp_nonce() }}">
                                        $(document).ready(function () {
                                            $("#remove_{{ campaign._id }}").click(function (e) {
                                                Swal.fire({
                                                    title: '{{ gettext("Ban_co_chac_chan_muon_xoa_khong?") }}',
                                                    type: 'warning',
                                                    showCancelButton: true,
                                                    confirmButtonColor: '#3085d6',
focusCancel: true,
                                                    cancelButtonColor: '#d33',
                                                    confirmButtonText: '{{ gettext("Co") }}!',
                                                    cancelButtonText: '{{ gettext("Khong") }}!'
                                                }).then((result) => {if(result.value){
                                                    $.ajax({
                                                        type: 'POST',
                                                        url: '/wifi',
                                                        data: {
                                                            'campaign_id': '{{ campaign._id }}',
                                                            'shop_id_select': '{{ shop_id_select }}',
                                                            'action': 'remove'
                                                        },
                                                        success: function (response) {
                                                            location.reload()
                                                            $.ajax({
                                                                type: 'GET',
                                                                url: '/wifi',
                                                                data: {
                                                                    'shop_id_select': '{{ shop_id_select }}',
                                                                },
                                                                success: function (response) {
                                                                    $('#body').empty();
                                                                    $('#body').append(response);
                                                                }
                                                            });
                                                        }
                                                    });
                                                }
                                            })
                                            });
                                        });
                                    </script>
                                       
                                </div>
                            {% endif %}
                        </div> <!-- / .row -->
                    </div>
                    <div class="card-body text-center">
                        <div class="row"
                             style="justify-content: center; display: flex; align-items: center;"
                             {% if campaign.step_1 == '0' and campaign.step_2 != '0' %}
                                data-step = 2
                                data-min_step = 2
                             {% elif campaign.step_1 == '0' and campaign.step_2 == '0' and campaign.step_3 != '0' %}
                                data-step = 3
                                data-min_step = 3
                             {% elif campaign.step_1 == '0' and campaign.step_2 == '0' and campaign.step_3 == '0' and campaign.step_4 != '0' %}
                                data-step = 4
                                data-min_step = 4
                             {% else %}
                                data-step = 1
                                data-min_step = 1
                             {% endif %}
                             data-campaign_id = '{{ campaign._id }}'
                             data-step_1 = '{{ campaign.step_1 }}'
                             data-step_1_id = '{{ campaign.step_1_id }}'
                             data-survey_step_1 = '{{ campaign.survey_step_1 }}'
                             data-spin_step_1 = '{{ campaign.spin_step_1 }}'
                             data-step_2 = '{{ campaign.step_2 }}'
                             data-step_2_id = '{{ campaign.step_2_id }}'
                             data-survey_step_2 = '{{ campaign.survey_step_2 }}'
                             data-spin_step_2 = '{{ campaign.spin_step_2 }}'
                             data-step_3 = '{{ campaign.step_3 }}'
                             data-step_3_id = '{{ campaign.step_3_id }}'
                             data-survey_step_3 = '{{ campaign.survey_step_3 }}'
                             data-spin_step_3 = '{{ campaign.spin_step_3 }}'
                        >
                            <a class="unactive-step btn prev-step-camp disabled" style="margin-right: 30px;">
                                <i class="fa fa-caret-left fa-5x"></i>
                            </a>

                        <div class="detail" id="preview_campaign_{{ campaign._id }}" ></div>
                        {% if campaign.step_1 == '0' and campaign.step_2 != '0'%}
                            <script nonce="{{ csp_nonce() }}">
                                $(document).ready(function () {
                                    var step_2 = '{{ campaign.step_2 }}';
                                    var step_2_id = '{{ campaign.step_2_id }}';
                                    var arr = ['register', 'plus_register', 'spin'];
                                    if (arr.includes(step_2)) {
                                        if (step_2 != 'spin') {
                                            var url_preview = '/preview/{{ shop_id_select }}/' + step_2;
                                            $("#preview_campaign_{{ campaign._id }}").empty();
                                            bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                url: url_preview,
                                                view: 'front',
                                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                width: 200
                                            });
                                        } else {
                                            var url_preview = '/game/' + '{{ campaign.spin_step_2 }}';
                                            $("#preview_campaign_{{ campaign._id }}").empty();
                                            bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                url: url_preview,
                                                view: 'front',
                                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                width: 200
                                            });
                                        }
                                    } else {
                                        if (step_2 == 'survey') {
                                            var url_preview = '/wifi/{{ shop_id_select }}/survey/' + '{{ campaign.survey_step_2 }}' + '/preview';
                                            $("#preview_campaign_{{ campaign._id }}").empty();
                                            bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                url: url_preview,
                                                view: 'front',
                                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                width: 200
                                            });
                                        }
                                        else if (step_2 == 'woay'){
                                            var url_preview = '{{ link_woay }}' + '?shop_id=' + '{{ shop_id_woay }}';
                                            $("#preview_campaign_{{ campaign._id }}").empty();
                                            bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                url: url_preview,
                                                view: 'front',
                                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                width: 200
                                            });
                                        }
                                         else {
                                            var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_2_id;
                                            $("#preview_campaign_{{ campaign._id }}").empty();
                                            bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                url: url_preview,
                                                view: 'front',
                                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                width: 200
                                            });
                                        }
                                    }
                                });
                            </script>
                             {% elif campaign.step_1 == '0' and campaign.step_2 == '0' and campaign.step_3 != '0' %}
                                <script nonce="{{ csp_nonce() }}">
                                    $(document).ready(function () {
                                        var step_3 = '{{ campaign.step_3 }}';
                                        var step_3_id = '{{ campaign.step_3_id }}';
                                        var arr = ['register', 'plus_register', 'spin'];
                                        if (arr.includes(step_3)) {
                                            if (step_3 != 'spin') {
                                                var url_preview = '/preview/{{ shop_id_select }}/' + step_3;
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            } else {
                                                var url_preview = '/game/' + '{{ campaign.spin_step_3 }}';
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            }
                                        } else {
                                            if (step_3 == 'survey') {
                                                var url_preview = '/wifi/{{ shop_id_select }}/survey/' + '{{ campaign.survey_step_3 }}'+ '/preview';
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            }
                                            else if (step_3 == 'woay'){
                                                var url_preview = '{{ link_woay }}' + '?shop_id=' + '{{ shop_id_woay }}';
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            }
                                             else {
                                                var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_3_id;
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            }
                                        }
                                    });
                                </script>
                             {% elif campaign.step_1 == '0' and campaign.step_2 == '0' and campaign.step_3 == '0' and campaign.step_4 != '0' %}
                                <script nonce="{{ csp_nonce() }}">
                                    $(document).ready(function () {
                                        var url_preview = '/splash_page/{{ shop_id_select }}/preview/connect_success';
                                        $("#preview_campaign_{{ campaign._id }}").empty();
                                        bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                            url: url_preview,
                                            view: 'front',
                                            image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                            width: 200
                                        });
                                    });
                                </script>
                             {% else %}
                                <script nonce="{{ csp_nonce() }}">
                                    $(document).ready(function () {
                                        var step_1 = '{{ campaign.step_1 }}';
                                        var step_1_id = '{{ campaign.step_1_id }}';
                                        var arr = ['register', 'plus_register', 'spin'];

                                        if (arr.includes(step_1)) {
                                            if (step_1 != 'spin') {
                                                var url_preview = '/preview/{{ shop_id_select }}/' + step_1;
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            } else {
                                                var url_preview = '/game/' + '{{ campaign.spin_step_1 }}';
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            }
                                        } else {
                                            if (step_1 == 'survey') {
                                                var url_preview = '/wifi/{{ shop_id_select }}/survey/' + '{{ campaign.survey_step_1 }}' + '/preview';
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            } 
                                            else if (step_1 == 'woay'){
                                                var url_preview = '{{ link_woay }}' + '?shop_id=' + '{{ shop_id_woay }}';
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            }
                                            else {
                                                var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_1_id;
                                                $("#preview_campaign_{{ campaign._id }}").empty();
                                                bioMp(document.getElementById('preview_campaign_{{ campaign._id }}'), {
                                                    url: url_preview,
                                                    view: 'front',
                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                                    width: 200
                                                });
                                            }
                                        }
                                    });
                                </script>
                             {% endif %}

{#                            {% if campaign.step_1 != '0' %}#}
{#                                <div class="detail" id="preview_1_{{ campaign._id }}" ></div>#}
{##}
{#                                <script nonce="{{ csp_nonce() }}">#}
{#                                    $(document).ready(function () {#}
{#                                        var step_1 = '{{ campaign.step_1 }}';#}
{#                                        var step_1_id = '{{ campaign.step_1_id }}';#}
{#                                        var arr = ['register', 'plus_register', 'spin'];#}
{##}
{#                                        if (arr.includes(step_1)) {#}
{#                                            if (step_1 != 'spin') {#}
{#                                                var url_preview = '/preview/{{ shop_id_select }}/' + step_1;#}
{#                                                $("#preview_1_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_1_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            } else {#}
{#                                                var url_preview = '/game/' + '{{ campaign.spin_step_1 }}';#}
{#                                                $("#preview_1_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_1_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            }#}
{#                                        } else {#}
{#                                            if (step_1 == 'survey') {#}
{#                                                var url_preview = '/wifi/{{ shop_id_select }}/survey/' + '{{ campaign.survey_step_1 }}' + '/preview';#}
{#                                                $("#preview_1_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_1_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            } else {#}
{#                                                var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_1_id;#}
{#                                                $("#preview_1_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_1_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            }#}
{#                                        }#}
{#                                    });#}
{#                                </script>#}
{#                                <button class="active-step btn"#}
{#                                        style="margin-right: 20px; margin-left: 20px; color: #f57a33">#}
{#                                    <i class="fa fa-caret-right fa-5x"></i>#}
{#                                </button>#}
{#                            {% endif %}#}


{#                            {% if campaign.step_2 != '0' %}#}
{#                                <div class="detail" id="preview_2_{{ campaign._id }}"></div>#}
{#                                <script nonce="{{ csp_nonce() }}">#}
{#                                    $(document).ready(function () {#}
{#                                        var step_2 = '{{ campaign.step_2 }}';#}
{#                                        var step_2_id = '{{ campaign.step_2_id }}';#}
{#                                        var arr = ['register', 'plus_register', 'spin'];#}
{#                                        if (arr.includes(step_2)) {#}
{#                                            if (step_2 != 'spin') {#}
{#                                                var url_preview = '/preview/{{ shop_id_select }}/' + step_2;#}
{#                                                $("#preview_2_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_2_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            } else {#}
{#                                                var url_preview = '/game/' + '{{ campaign.spin_step_2 }}';#}
{#                                                $("#preview_2_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_2_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            }#}
{#                                        } else {#}
{#                                            if (step_2 == 'survey') {#}
{#                                                var url_preview = '/wifi/{{ shop_id_select }}/survey/' + '{{ campaign.survey_step_2 }}' + '/preview';#}
{#                                                $("#preview_2_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_2_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            } else {#}
{#                                                var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_2_id;#}
{#                                                $("#preview_2_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_2_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            }#}
{#                                        }#}
{#                                    });#}
{#                                </script>#}
{##}
{#                                <button class="active-step btn"#}
{#                                        style="margin-right: 20px; margin-left: 20px; color: #f57a33">#}
{#                                    <i class="fa fa-caret-right fa-5x"></i>#}
{#                                </button>#}
{#                            {% endif %}#}
{##}
{#                            {% if campaign.step_3 != '0' %}#}
{#                                <div class="detail" id="preview_3_{{ campaign._id }}"></div>#}
{#                                <script nonce="{{ csp_nonce() }}">#}
{#                                    $(document).ready(function () {#}
{#                                        var step_3 = '{{ campaign.step_3 }}';#}
{#                                        var step_3_id = '{{ campaign.step_3_id }}';#}
{#                                        var arr = ['register', 'plus_register', 'spin'];#}
{#                                        if (arr.includes(step_3)) {#}
{#                                            if (step_3 != 'spin') {#}
{#                                                var url_preview = '/preview/{{ shop_id_select }}/' + step_3;#}
{#                                                $("#preview_3_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_3_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            } else {#}
{#                                                var url_preview = '/game/' + '{{ campaign.spin_step_3 }}';#}
{#                                                $("#preview_3_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_3_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            }#}
{#                                        } else {#}
{#                                            if (step_3 == 'survey') {#}
{#                                                var url_preview = '/wifi/{{ shop_id_select }}/survey/' + '{{ campaign.survey_step_3 }}'+ '/preview';#}
{#                                                $("#preview_3_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_3_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            } else {#}
{#                                                var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_3_id;#}
{#                                                $("#preview_3_{{ campaign._id }}").empty();#}
{#                                                bioMp(document.getElementById('preview_3_{{ campaign._id }}'), {#}
{#                                                    url: url_preview,#}
{#                                                    view: 'front',#}
{#                                                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                                    width: 200#}
{#                                                });#}
{#                                            }#}
{#                                        }#}
{#                                    });#}
{#                                </script>#}

{#                                <button class="active-step btn"#}
{#                                        style="margin-right: 20px; margin-left: 20px; color: #f57a33">#}
{#                                    <i class="fa fa-caret-right fa-5x"></i>#}
{#                                </button>#}
{#                            {% endif %}#}

{#                            <div class="detail" id="preview_4_{{ campaign._id }}"></div>#}
{#                            <script nonce="{{ csp_nonce() }}">#}
{#                                $(document).ready(function () {#}
{#                                    var url_preview = '/splash_page/{{ shop_id_select }}/preview/connect_success';#}
{#                                    $("#preview_4_{{ campaign._id }}").empty();#}
{#                                    bioMp(document.getElementById('preview_4_{{ campaign._id }}'), {#}
{#                                        url: url_preview,#}
{#                                        view: 'front',#}
{#                                        image: '/static/images/iphone_simulator/img_preview_mobile.svg',#}
{#                                        width: 200#}
{#                                    });#}
{#                                });#}
{#                            </script>#}
                        <a class="active-step btn next-step-camp" style="margin-left: 30px;">
                            <i class="fa fa-caret-right fa-5x"></i>
                        </a>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
    <input type="hidden" value="{{ total_pages }}" id="total"/>
    <div class="c-pagination u-justify-center">
        <ul id="example_pagination" class="pagination justify-content-center"> 
            {% if pagination %}
                {{ pagination.links }}
            {% endif %}
        </ul>
    </div>
{% else %}
    <div class="col-12 col-md-8 col-xl-8" style="margin: auto">
        <div class="row">
            <div class="col-lg-12">
                <div class="u-p-medium">
                    <div class="row u-justify-center">
                        <div class="col-lg-6">
                            <div class="u-mt-large u-text-center">
                                <h4 class="u-mb-xsmall">{{ gettext("Them_trang_chao") }}</h4>
                                <p class="u-text-mute u-mb-large"></p>
                            </div>
                            <form method="POST" enctype="multipart/form-data" id="form_new_image">
                                <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}"/>
                                <div class="col-lg-12">
                                    <div class="c-field u-mb-xsmall">
                                        <label class="c-field__label" for="photo">{{ gettext("Anh:") }}</label>
                                        <p class="help-block">
                                            <img id="img_new_photo" width="200">
                                        </p>
                                        <input class="c-input" type="file" class="form-control" id="new_photo"
                                               name="photo">
                                    </div>
                                    <div class="c-field u-mb-xsmall">
                                        <label class="c-field__label" for="title">{{ gettext("Tieu_de:") }}</label>
                                        <input class="c-input" type="text" maxlength="70"
                                               class="form-control form-input" id="title" name="title"
                                               placeholder='{{ gettext("(Khong_bat_buoc)") }}'>
                                    </div>
                                    <div class="c-field u-mb-xsmall">
                                        <label class="c-field__label" for="content">{{ gettext("Noi_dung:") }}</label>
                                        <textarea class="c-input" id="content" name="content" rows="6" maxlength="1000"
                                                  placeholder='{{ gettext("(Khong_bat_buoc)") }}'></textarea>
                                    </div>
                                </div>
                                <button id="new_splash_submit" class="c-btn c-btn--info u-float-right">
                                    {{ gettext("Luu_thong_tin") }}
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endif %}
<script src="/static/nextify/js/jquery.bootpag.min.js"></script>
<script nonce="{{ csp_nonce() }}">
    $(document).ready(function () {

        $(".c-switch").on("click", function (t) {
            var e = $(this).find(".c-switch__input");
            return $(this).hasClass("is-disabled") || ($(this).hasClass("is-active") && e.attr("checked") ? (e.removeAttr("checked"), $(this).removeClass("is-active")) : (e.attr("checked", "checked"), $(this).addClass("is-active"))), !1
        });

        $('#example_pagination').bootpag({
            total: parseInt($("#total").val()),
            maxVisible: 5,
            firstLastUse: true,
            first: '←',
            last: '→',
            nextClass: 'next',
            prevClass: 'prev',
            lastClass: 'last',
            firstClass: 'first'
        }).on("page", function (event, /* page number here */ num) {
            var shop_id_select = '{{ shop_id_select }}';
            $.ajax({
                type: 'POST',
                url: '/hotspot_campaign_shop',
                data: {
                    'shop_id_select': shop_id_select,
                    'page': num
                },
            }).done(function (response) {
                $('#campaign_pagination').empty();
                $('#campaign_pagination').append(response);
            }).fail(function (error) {
            });
        });

        function readURL(input, input_view) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                var view_id = '#' + input_view;
                reader.onload = function (e) {
                    $(view_id).attr('src', e.target.result);
                }

                reader.readAsDataURL(input.files[0]);
            }
        };

        function validate(photo) {
            var file_size = $(photo)[0].files[0].size;

            var file = $(photo).val();
            var exts = ['jpg', 'png', 'jpeg'];
            if (file) {
                var get_ext = file.split('.');
                get_ext = get_ext.reverse();
                if ($.inArray(get_ext[0].toLowerCase(), exts) > -1) {
                    if (file_size > 3670016) {
                        return "big_file";
                    } else {
                        return true;
                    }
                } else {
                    return false;
                }
            }

        };

        $("#new_photo").change(function () {
            var validate_photo = validate(this);
            if (validate_photo == true) {
                swal('{{ gettext("Upload_thanh_cong") }}', '', 'success');
                $('#img_new_photo').show();
                readURL(this, 'img_new_photo');
            } else {
                if (validate_photo == "big_file") {
                    swal('{{ gettext("File_co_kich_thuoc_qua_lon!") }}', '', 'error');
                    return false
                }
                ;
                swal('{{ gettext("File_khong_dung_dinh_dang") }}', '', 'error');
                $('#new_photo').val('');
                $('#img_new_photo').hide();
                return false

            }
        });

        $("#new_splash_submit").click(function (e) {
            var form_data = new FormData();
            var content = $('#content').val();
            var title = $('#title').val();
            var photo = $('#new_photo')[0].files[0];
            if (typeof photo == 'undefined') {
                swal('{{ gettext("Ban_phai_tai_len_anh_trang_chao!") }}', '', 'error');
                return false;
            }
            ;
            form_data.append('content', content)
            form_data.append('title', title)
            form_data.append('photo', photo)
            $.ajax({
                headers: {"X-CSRFToken": '{{ csrf_token() }}'},
                url: "/new_splash_page/{{ shop_id_select }}/item/add?page_type=default",
                type: 'POST',
                data: form_data,
                contentType: false,
                processData: false,
                success: function () {
                    swal({
                        title: '{{ gettext("Thanh_cong!") }}',
                        text: " ",
                        type: "success",
                        timer: 2000
                    }).then(function () {
                        location.href = '/wifi';
                    })
                }
            });
            return false;
        });

        function show_preview(current_step, campaign_id, step_1, step_1_id, survey_step_1, spin_step_1, step_2, step_2_id, survey_step_2, spin_step_2, step_3, step_3_id, survey_step_3, spin_step_3){
            if (current_step == 1){
                if (step_1 == '0') {
                    $("#preview_campaign_" + campaign_id).empty();
                    bioMp(document.getElementById('preview'), {
                        url: '',
                        view: 'front',
                        image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                        height: 418,
                        width: 200
                    });
                }
                else{
                    var arr = ['register', 'plus_register', 'spin'];
                    if (arr.includes(step_1)) {
                        if (step_1 != 'spin') {
                            var url_preview = '/preview/{{ shop_id_select }}/' + step_1;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        } else {
                             var url_preview = '/game/' + spin_step_1;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        }
                    } else {
                        if (step_1 == 'survey') {
                            var url_preview = '/wifi/{{ shop_id_select }}/survey/' + survey_step_1 + '/preview';
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        }
                        else if (step_1 == 'woay'){
                            var url_preview = '{{ link_woay }}' + '?shop_id=' + '{{ shop_id_woay }}';
                            $("#preview_campaign_"+ campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                width: 200
                            });
                        }
                         else {
                            $("#preview").empty();
                            var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_1_id;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        }
                    }
                }
            }
            if (current_step == 2){
                if (step_2 == '0') {
                    $("#preview_campaign_" + campaign_id).empty();
                    bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                        url: '',
                        view: 'front',
                        image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                        height: 418,
                        width: 200
                    });
                }
                else{
                    var arr = ['register', 'plus_register', 'spin'];
                    if (arr.includes(step_2)) {
                        if (step_2 != 'spin') {
                            var url_preview = '/preview/{{ shop_id_select }}/' + step_2;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        } else {
                            var url_preview = '/game/' + spin_step_2;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        }
                    } else {
                        if (step_2 == 'survey') {
                            var url_preview = '/wifi/{{ shop_id_select }}/survey/' + survey_step_2 + '/preview';
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        } 
                        else if (step_2 == 'woay') {
                            var url_preview = '{{ link_woay }}' + '?shop_id=' + '{{ shop_id_woay }}';
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        } 
                        else {
                            var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_2_id;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        }
                    }
                }
            }
            else if(current_step == 3){
                if (step_3 == '0') {
                    $("#preview_campaign_" + campaign_id).empty();
                    bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                        url: '',
                        view: 'front',
                        image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                        height: 418,
                        width: 200
                    });
                }
                else{
                    var arr = ['register', 'plus_register', 'spin'];
                    if (arr.includes(step_3)) {
                        if (step_3 != 'spin') {
                            var url_preview = '/preview/{{ shop_id_select }}/' + step_3;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                width: 200
                            });
                        } else {
                            var url_preview = '/game/' + spin_step_3;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                width: 200
                            });
                        }
                    } else {
                        if (step_3 == 'survey') {
                            var url_preview = '/wifi/{{ shop_id_select }}/survey/' + survey_step_3 + '/preview';
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                width: 200
                            });
                        } 
                        else if (step_3 == 'woay') {
                            var url_preview = '{{ link_woay }}' + '?shop_id=' + '{{ shop_id_woay }}';
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                height: 418,
                                width: 200
                            });
                        } 
                        else {
                            var url_preview = '/splash_page/{{ shop_id_select }}/preview/' + step_3_id;
                            $("#preview_campaign_" + campaign_id).empty();
                            bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                                url: url_preview,
                                view: 'front',
                                image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                                width: 200
                            });
                        }
                    }
                }
            }
            else if(current_step == 4){
                var url_preview = '/splash_page/{{ shop_id_select }}/preview/connect_success';
                $("#preview_campaign_" + campaign_id).empty();
                bioMp(document.getElementById('preview_campaign_'+ campaign_id), {
                    url: url_preview,
                    view: 'front',
                    image: '/static/images/iphone_simulator/img_preview_mobile.svg',
                    width: 200
                });
            }
        }

        $('.next-step-camp').click(function(){
            var current_step = $(this).closest('div').data('step');
            var min_step = $(this).closest('div').data('min_step');
            var campaign_id = $(this).closest('div').data('campaign_id');
            var step_1 = $(this).closest('div').data('step_1');
            var step_1_id = $(this).closest('div').data('step_1_id');
            var survey_step_1 = $(this).closest('div').data('survey_step_1');
            var spin_step_1 = $(this).closest('div').data('spin_step_1');
            var step_2 = $(this).closest('div').data('step_2');
            var step_2_id = $(this).closest('div').data('step_2_id');
            var survey_step_2 = $(this).closest('div').data('survey_step_2');
            var spin_step_2 = $(this).closest('div').data('spin_step_2');
            var step_3 = $(this).closest('div').data('step_3');
            var step_3_id = $(this).closest('div').data('step_3_id');
            var survey_step_3 = $(this).closest('div').data('survey_step_3');
            var spin_step_3 = $(this).closest('div').data('spin_step_3');

            current_step = current_step + 1;
            if (current_step == 2 && step_2 == '0') current_step = current_step + 1;
            if (current_step == 3 && step_3 == '0') current_step = current_step + 1;
            $(this).closest('div').data('step', current_step);
            show_preview(current_step, campaign_id,  step_1, step_1_id, survey_step_1, spin_step_1, step_2, step_2_id, survey_step_2, spin_step_2, step_3, step_3_id, survey_step_3, spin_step_3);
            if (current_step == 4){
                $(this).addClass("disabled");
            }
            if (current_step > min_step){

                $(this).closest('div').find('a.prev-step-camp').removeClass("disabled");
            }
        });
        $('.prev-step-camp').click(function(){
            var current_step = $(this).closest('div').data('step');
            var min_step = $(this).closest('div').data('min_step');
            var campaign_id = $(this).closest('div').data('campaign_id');
            var step_1 = $(this).closest('div').data('step_1');
            var survey_step_1 = $(this).closest('div').data('survey_step_1');
             var spin_step_1 = $(this).closest('div').data('spin_step_1');
            var step_1_id = $(this).closest('div').data('step_1_id');
            var step_2 = $(this).closest('div').data('step_2');
            var step_2_id = $(this).closest('div').data('step_2_id');
            var survey_step_2 = $(this).closest('div').data('survey_step_2');
            var spin_step_2 = $(this).closest('div').data('spin_step_2');
            var step_3 = $(this).closest('div').data('step_3');
            var step_3_id = $(this).closest('div').data('step_3_id');
            var survey_step_3 = $(this).closest('div').data('survey_step_3');
            var spin_step_3 = $(this).closest('div').data('spin_step_3');

            current_step = current_step - 1;
            if (current_step == 3 && step_3 == '0') current_step = current_step - 1;
            if (current_step == 2 && step_2 == '0') current_step = current_step - 1;
            $(this).closest('div').data('step', current_step);
            show_preview(current_step, campaign_id, step_1, step_1_id, survey_step_1, spin_step_1, step_2, step_2_id, survey_step_2, spin_step_2, step_3, step_3_id, survey_step_3, spin_step_3);

            if(current_step == min_step){
                $(this).addClass("disabled");
            }
            if (current_step < 4){
                $(this).closest('div').find('a.next-step-camp').removeClass("disabled");
            }
        });
    });
</script>